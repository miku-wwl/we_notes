订单超时自动取消功能如何设计，订单超时自动取消功能怎么去设计？最近一个工作7年的粉丝去面试，因为这个问题没有回答出来，导致错过了一个高薪的offer。因为现在很多小伙伴看到这个问题的时候，第一反应肯定是另外我把网签的内容都打包在了Java面试指南中，里面包含了35万字面试文档，200份精选简历模板以及Java架构师学习路线图。这个问题很简单，直接首页定时任务去轮选数据库，根据订单时间去找到超时的订单，把它取消就行了。那个工作去年粉丝也是这么回答结果。这种方式很明显存在几个问题，第一个是允许会存在延迟时间，也就是没有办法准时的去实现订单的取消，去释放这个订单锁定的资源。第二个是轮巡数据库会给数据库造成很大的压力，如果订单表的数据量比较大的情况下，轮巡的效率如果要考虑到性能，又要去考虑到实质性，有没有更好的方法？当然有比如时间的算法，这种算法是采用了一个典型的环状速度加链表的方式去管理延迟任务，我们只需要去计算这个订单的超时时间，再把它加入到时间人力里面就好了。
	时间轮算法的唯一缺点就是无法持久化，所以我们在服务重启之后需要去重新漏的一次订单数据，确保所有订单数据都能够被准时处理。第二种我们可以利用主流的mq里面的延迟消息的功能，延迟消息的特点就是我们把消息发送到博客上以后，他并不会立刻投递，而是根据消息里面设置颜值直接去投递。我们只需要把新的订单计算出这个订单的超时时间，发送mq里面就好了。实际上mq里面的颜值消息的处理很多也是用的石杰伦，比如说卡夫卡里面的颜值消息也是用到了石杰伦的算法，mq这种方式啊在性能上在可扩展性上，在稳定性上都比较好，是一个比较不错的选择。好了，今天我的分享就到这里了，大家如果有更好的实践方案，可以在评论区留言。
